package JavaApp;

import java.sql.DriverManager;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.JSONValue; 

import twitter4j.*;
import twitter4j.auth.AccessToken;

public class Rest_search extends Search {

	private Bounding_box_rest bb;
	private User_info ui;


	public Rest_search() {
		super();
		bb = null;
		ui = new User_info();
	}



	public Rest_search(ArrayList<String> k, ArrayList<String> h, String l) {
		super(k, h, l);
		// TODO Auto-generated constructor stub
	}



	public User_info getUi() {
		return ui;
	}

	public void setUi(User_info ui) {
		this.ui = ui;
	}

	public Bounding_box_rest getBb() {
		return bb;
	}

	public void setBb(Bounding_box_rest bb) {
		this.bb = bb;
	}

	public void search_and_insert() throws TwitterException{
		String kw_ht = "";
		
		if(bb.equals(null))
		{
			if(keywords.size() != 0)
			{
				for(int i=0;i < keywords.size()-1;i++)
				{
					if(keywords.get(i).indexOf(" ") != -1)
						kw_ht += "\""+keywords.get(i)+"\"" + " OR ";
					else
						kw_ht += keywords.get(i)+" OR ";
				}
				kw_ht += keywords.get(keywords.size()-1);
			}
	
			if(hashtags.size() != 0 && !kw_ht.equals(""))
				kw_ht += " OR ";
			if(hashtags.size() != 0)
			{
				for(int i=0;i < hashtags.size()-1;i++)
				{
					kw_ht += hashtags.get(i)+" OR ";
				}
				kw_ht += hashtags.get(hashtags.size()-1);
			}
		}
		
		final String CONSUMER_KEY = "79Le46VDtImQBogLVkr97dmQr";
		final String CONSUMER_SECRET = "7v6CkcUkcP7Ra9OiDOz84dKANkE9DrPIZbmtL2WCqvQdedDMtg";
 
		final String ACCESS_TOKEN = "950171118-poLCn3nOTIRtb83KJjLS4zA4VVhyR0QSqpl72nVI";
		final String ACCESS_TOKEN_SECRET = "tqzL8zmvE1VzYIDP5F7q3IUEOVOTm6k2vpTXN6Me4Y8Bt";
 
		String message = "Statut de test envoyé via la bibliothèque #Twitter4j.";
 
		AccessToken aToken;
 
		// Creation d'un objet Twitter
 
		Twitter t = new TwitterFactory().getInstance();
 
		// Connexion OAuth (http://oauth.net/) au compte Twitter
 
		t.setOAuthConsumer(CONSUMER_KEY, CONSUMER_SECRET);
		aToken = new AccessToken(ACCESS_TOKEN, ACCESS_TOKEN_SECRET);
		t.setOAuthAccessToken(aToken);
 
	    Query query = new Query("usa OR france");
	    QueryResult result = t.search(query);
	    for (Status status : result.getTweets()) {
	        System.out.println("@" + status.getUser().getScreenName() + ":" + status.getText());
	    }

	}
}
